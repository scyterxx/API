use crate::device::DeviceManager;
use crate::ebpf::shared::load_shared;
use crate::monitor::{ConnectionModuleContext, DnsModuleContext, ModuleContext, MonitorManager, TrafficModuleContext};
use crate::monitor::traffic;
use crate::monitor::connection;
use crate::monitor::dns;
use crate::system::log_startup_info;
use crate::utils::network_utils::get_interface_info;
use crate::web;

use aya::maps::Array;
use clap::{Args, Parser};

// ✅ FLUSH SYSTEM IMPORTS
use std::sync::atomic::{AtomicBool, Ordering};
use std::sync::{Arc, Mutex};
use std::time::Duration;

use scopeguard;

use log::info;
use log::LevelFilter;
use tokio::signal;

// ✅ ATOMIC FLUSH GUARD
static FLUSH_IN_PROGRESS: AtomicBool = AtomicBool::new(false);
